{% extends 'gwells/base.html' %}
{% load crispy_forms_tags pagination_tags sorting_tags %}

{% block title %}Search{% endblock %}

{% block bodyheading_block %}Search{% endblock %}

{% block introduction_block %}
    <ul>
        <li>Search by well tag or well ID plate number (if known) for the most precise results</li>
        <li>If not known, try searching with one or more additional fields</li>
        <li>Use <a href="#">Advanced Search</a> for additional search options</li>
    </ul>
    <br />
{% endblock %}

{% block body_block %}

<div class="row">
    <div class="col-sm-4">
        {% crispy form %}         
    </div>
    <div class="col-sm-8">
    </div>
</div>
<br />

{% if well_list %}
    {% autosort well_list %}
    {% autopaginate well_list 25 %}
        <div class="row">
            <div class="col-sm-12">
                {{ page_obj.start_index }}-{{ page_obj.end_index }} of {{ page_obj.paginator.count }} results
                <br /><br />
            </div>
        </div>

        <div class="row row-header">
            <div class="col-sm-1">
                {% anchor well_tag_number "Well Tag #" %}
            </div>
            <div class="col-sm-1">
                {% anchor identification_plate_number "Well ID Plate #" %}
            </div>
            <div class="col-sm-2">
                {% anchor owner_full_name "Owner Name" %}
            </div>
            <div class="col-sm-1">
                {% anchor street_address "Street Address" %}
            </div>
            <div class="col-sm-1">
                {% anchor legal_lot "Lot" %}
            </div>
            <div class="col-sm-1">
                {% anchor legal_plan "Plan" %}
            </div>
            <div class="col-sm-1">
                {% anchor legal_district_lot "District Lot" %}
            </div>
            <div class="col-sm-1">
                {% anchor legal_land_district "Land District" %}
            </div>
            <div class="col-sm-1">
                {% anchor legal_pid "PID" %}
            </div>
            <div class="col-sm-1">
                {% anchor diameter "Diameter (in)" %}
            </div>
            <div class="col-sm-1">
                {% anchor finished_well_depth "Finished Well Depth (ft)" %}
            </div>
        </div>

    {% for well in well_list %}
        <div class="row row-bordered">
            <div class="col-sm-1">
                <a href="{% url 'well_detail' well.well_tag_number %}">{{ well.well_tag_number }}</a>
            </div>
            <div class="col-sm-1">
                {{ well.identification_plate_number|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-2">
                {{ well.owner_full_name|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.street_address|default_if_none:'' }}
                {{ well.city|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.legal_lot|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.legal_plan|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.legal_district_lot|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.legal_land_district.name|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.legal_pid|stringformat:"09d"|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.diameter|default_if_none:'&nbsp;' }}
            </div>
            <div class="col-sm-1">
                {{ well.finished_well_depth|default_if_none:'&nbsp;' }}
            </div>
        </div>
    {% endfor %}


    <div class="row">
        {% paginate using 'gwells/bootstrap_pagination.html' %}
    </div>
     
        	
{% elif 'well' in request.GET %}
    <div class="row">
        <div class="col-sm-12">
            <em>No well records could be found.</em>
        </div>
    </div>

{% endif %}

        <br />
{% if 'well' in request.GET %}
    <p>
        Canâ€™t find the well you are looking for? Try your search again using a different set of criteria. If you still need more assistance, Contact <a href="https://portal.nrs.gov.bc.ca/web/client/contact">FrontCounterBC</a>.
    </p>
{% endif %}

<div id="search-map"></div>

<!-- EXPERIMENTAL CODE FOR FUTURE ADD PAGE; THE FOLLOWING IS ***NOT*** SEARCH PAGE CODE!!! -->



<!-- /EXPERIMENTAL CODE -->

        <p>
            We may not have a copy of your well record. Until February 29, 2016, it was voluntary for well drillers to submit well records to the Province. 
            Issues related to data quality may make finding your well record difficult.
        </p>


{% endblock %}

{% block jqscript_block %}
    <script>
        $(document).ready(function(){
            $('[data-toggle="popover"]').popover({'trigger':'hover'});
            // The search page has a map.
            var searchMap = wellsMap.createMap('search-map');

            /* EXPERIMENTAL CODE FOR FUTURE ADD PAGE; THE FOLLOWING IS ***NOT*** SEARCH PAGE CODE!!! */

        });
    </script>
{% endblock %}